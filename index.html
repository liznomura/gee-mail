<html>
    <head>
        <script src="js/mail-generator.js"></script>
        <link href="css/style.css" rel="stylesheet" media="screen">
        <link href="https://fonts.googleapis.com/css?family=Muli" rel="stylesheet">
    <script>
     window.onload = function(){
         // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
         // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser

         //inbox count
         var inboxCount = document.getElementById('mailCount');
         inboxCount.innerHTML = "Emails: " + window.geemails.length;
         
         function displayEmails(emails, index) {
            var table = document.getElementById('tbody');
            var row = document.createElement('tr');
            row.className = ('row');
            row.id = index-1;

            var emailSender = document.createElement('td');
            emailSender.className = ('sender');
            emailSender.innerHTML = emails.sender;
            row.appendChild(emailSender);

            var emailSubject = document.createElement('td');
            emailSubject.class = ('subject');
            emailSubject.innerHTML = emails.subject;
            row.appendChild(emailSubject);

            var emailBody = document.createElement('td');
            emailBody.class = ('body');
            emailBody.innerHTML = emails.body;

            var emailDate = document.createElement('td');
            emailDate.class = ('date');
            emailDate.innerHTML = emails.date;
            row.appendChild(emailDate);
            
            table.appendChild(row);
         }

         for(var i = 0; i < window.geemails.length; i++) {
            displayEmails(window.geemails[i], i + 1);
         }
         
         function displayContent(index){
            //display overlay
            var overlay = document.getElementById('overlay');
            overlay.className = 'overlay';
            
            //get email data
            var email = window.geemails[index];
            
            //put data to box
            document.getElementById('popupSubject').innerHTML = email.subject;
            document.getElementById('popupSender').innerHTML = email.sender;
            document.getElementById('popupDate').innerHTML = email.date;
            document.getElementById('popupBody').innerHTML = email.body;
            
            //add handler to close button
            document.getElementById('popupClose').onclick = function(){
               overlay.className = 'none';
            };
         }
         
         //add action handler
         var rows = document.getElementsByClassName('row');
         var len = rows.length;
         for(var i = 0; i < len; i++){
            var row = rows[i];
            row.onclick = function(){
               displayContent(this.id);
            };
         }
      };
    </script>
    </head>
    <body>
        <div id="sidebar">
    <ul class ="navigation">
    <li class="active"><a href="#">Inbox</a></li>
    <li><a href="#">Sent</a></li>
    <li><a href="#">Trash</a></li>
    <li style="float:right"><p id="mailCount"></p></li>
    </ul>
    </div>
      <div id="overlay" class="none">
         <div class="popup">
            <div id="popupClose">X</div>
            <p id="popupSubject"></p>
            <p id="popupSender"></p>
            <p id="popupDate"></p>
            <p id="popupBody"></p>
         </div>
      </div>
        <div class="container" id="main">
            <table>
             <tbody id="tbody">
             </tbody>
         </table>
        </div>
    </body>
</html>